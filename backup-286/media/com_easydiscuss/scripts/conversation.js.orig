EasyDiscuss.module("conversation",function(e){var t=this;EasyDiscuss.require().library("markitup").view("conversation.read.item").done(function(e){EasyDiscuss.Controller("Conversation.Form",{defaultOptions:{"{textEditor}":".replyMessage"}},function(e){return{init:function(){e.initBBCode()},initBBCode:function(){e.textEditor().markItUp({set:"bbcode_easydiscuss"})}}}),EasyDiscuss.Controller("Conversation.Read",{defaultOptions:{"{replyList}":".replyList","{deleteMessage}":".deleteMessage","{unreadMessage}":".unreadMessage","{replyForm}":".replyForm","{replyButton}":".replyButton","{replyMessage}":".replyMessage",messageId:null,view:{reply:"conversation.read.item"}}},function(e){return{init:function(){e.replyForm().implement(EasyDiscuss.Controller.Conversation.Form,{"{textEditor}":".replyMessage"}),e.options.messageId=e.element.data("id")},"{deleteMessage} click":function(){disjax.loadingDialog(),disjax.load("conversation","confirmDelete",e.options.messageId+"")},"{replyButton} click":function(){e.replyButton().addClass("disabled"),EasyDiscuss.ajax("site.views.conversation.reply",{id:e.options.messageId,message:e.replyMessage().val()}).done(function(t){e.replyButton().removeClass("disabled");var n=e.view.reply({post:t});e.replyMessage().val(""),e.replyList().append(n)})}}}),t.resolve()})});